<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- CSRF Token -->
<meta name="csrf-token" content="{{ csrf_token() }}">

<title>
    Vote
</title>
<!-- <link rel="shortcut icon" href="{{ asset('img/favicon.png') }}"/> -->
<script>
</script>
<!-- Styles -->
<!-- <link href="{{ asset('css/app.css') }}" rel="stylesheet"> -->
<link href="./css/destyle.css" rel="stylesheet">
<link href="./css/style.css" rel="stylesheet">
<link rel="preconnect" href="https://fonts.gstatic.com">
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP&display=swap" rel="stylesheet">
<script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.2/Chart.bundle.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/threejs/r84/three.min.js"></script>
<script src="./js/custom.js"></script>
<link href="https://use.fontawesome.com/releases/v5.6.1/css/all.css" rel="stylesheet">

</head>
<body>
  <div class="vo-profile__wrapper">
  <div class="vo-profile">
    <div class="vo-profile__header">
      <div class="vo-profile__group">
        <img src="./assets/img/profile-img02.jpeg">
        <div>
          <div class="vo-profile__name">
            <!-- むらかみ。 -->
          </div>
          <div class="vo-profile__id">
            @micolumn123
          </div>
          <div class="vo-profile__follows">
            <div class="vo-profile__follow">
              64
            </div>
            <div class="vo-profile__follower">
              138
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
  <div class="vo-contents">
    <h2 class="vo-title vo-title--h5 vu-mb16"><i class="vo-icon vo-icon--yellow vu-mr08 fas fa-star"></i>あなたのvote</h2>
    <div class="vo-card--wrapper">
      <!-- <div class="vo-card">
        <a href="mypage-detail.html">
          <div class="vo-card__image">
            <img src="./assets/img/pizza.png">
          </div>
          <div class="vo-card__title">
            <p>寿司</p>
          </div>
        </a>
      </div>
      <div class="vo-card">
        <div class="vo-card__image">
          <img src="./assets/img/pizza.png">
        </div>
        <div class="vo-card__title">
          <p>カレー</p>
        </div>
      </div>
      <div class="vo-card">
        <div class="vo-card__image">
          <img src="./assets/img/pizza.png">
        </div>
        <div class="vo-card__title">
          <p>パスタ</p>
        </div>
      </div>
      <div class="vo-card">
        <div class="vo-card__image">
          <img src="./assets/img/pizza.png">
        </div>
        <div class="vo-card__title">
          <p>ピザ</p>
        </div>
      </div>
      <div class="vo-card">
        <div class="vo-card__image">
          <img src="./assets/img/pizza.png">
        </div>
        <div class="vo-card__title">
          <p>うどん/そば</p>
        </div>
      </div>
      <div class="vo-card">
        <div class="vo-card__image">
          <img src="./assets/img/pizza.png">
        </div>
        <div class="vo-card__title">
          <p>タピオカ</p>
        </div>
      </div>
      <div class="vo-card">
        <div class="vo-card__image">
          <img src="./assets/img/pizza.png">
        </div>
        <div class="vo-card__title">
          <p>中華</p>
        </div>
      </div>
      <div class="vo-card">
        <div class="vo-card__image">
          <img src="./assets/img/pizza.png">
        </div>
        <div class="vo-card__title">
          <p>ラーメン</p>
        </div>
      </div>
      <div class="vo-card">
        <div class="vo-card__image">
          <img src="./assets/img/pizza.png">
        </div>
        <div class="vo-card__title">
          <p>ハンバーグ</p>
        </div>
      </div>
      <div class="vo-card">
        <div class="vo-card__image">
          <img src="./assets/img/pizza.png">
        </div>
        <div class="vo-card__title">
          <p>ハンバーガー</p>
        </div>
      </div>
      <div class="vo-card">
        <div class="vo-card__image">
          <img src="./assets/img/pizza.png">
        </div>
        <div class="vo-card__title">
          <p>オムライス</p>
        </div>
      </div> -->
    </div>
    <div id="modal" style="display:none;">
      <p>これはサンプルです。</p>
    </div>
  </div>
  <footer class="vo-footer">
  <ul class="vo-footer__list">
    <li class="vo-footer__item">
      <a href="#">
        <i class="fas fa-crown"></i>
        <p>ランキング</p>
      </a>
    </li>
    <li class="vo-footer__item">
      <a href="mypage.html">
        <i class="fas fa-user"></i>
        <p>マイページ</p>
      </a>
    </li>
  </ul>
</footer>
  <script>
      window.onload = function() {
        $.ajax('http://kensyu.jeez.jp/api/mypage',
          {
            headers: {
              "token" : getToken()
            },
            type: 'get'
          }
        )
        // 検索成功時にはページに結果を反映
        .done(function(data) {
          console.log(data['user']);
          $('.vo-profile__name').text("ゲストユーザー"+data["result"]["user"]["id"]);
        })
        // 認証失敗はloginページに
        .fail(function(data, status, xhr) {
          if (data.status === 401) {
            alert("ログイン認証に失敗しました");
            location.href="./login.html";
          }else{
            alert("予期せぬエラーが発生しました");
          }
        });

        $.ajax('http://kensyu.jeez.jp/api/category',
          {
            type: 'get'
          }
        )
        // 検索成功時にはページに結果を反映
        .done(function(data) {
          var categories = data['result']['categories'];
          for(var i = 0; i < categories.length; i++){
            $('.vo-card--wrapper').append(
            '<div class="vo-card">'+
              '<a href="mypage-detail.html?category='+categories[i]['id']+'">'+
                '<div class="vo-card__image">'+
                  '<img src="./assets/img/pizza.png">'+
                '</div>'+
                '<div class="vo-card__title">'+
                  '<p>'+categories[i]['name']+'</p>'+
                '</div>'+
              '</a>'+
            '</div>'
            );
          }
        })
        // 検索失敗時には、その旨をダイアログ表示
        .fail(function(data) {
          console.error(data)
        });
      };
  </script>
</body>
</html>
