<!DOCTYPE html>
<html>
<head>
  <%- include('config/_head'); %>
</head>
<body class="vo-splash">
  <div class="contents">
    <div class="logo">
      <img src="./assets/img/vote-logo-name.png">
      <p>みんなの投票で決める街のグルメアプリ</p>
    </div>
    <div class="vo-form">
      <div class="vo-form__wrapper">
        <div class="vo-form__item">
          <input class="vo-form__password" type="password" id="pass" placeholder="パスワード">
        </div>
        <div class="vo-form__item">
          <input type="radio" id="non" name="gender" value="" checked>
          <label for="non">未選択</label>
          <input type="radio" id="male" name="gender" value="male">
          <label for="non">男性</label>
          <input type="radio" id="female" name="gender" value="female">
          <label for="non">女性</label>
          </div>
      </div>
      <button class="vo-button vo-button--primary vo-button--large"><a href="#" id="register">登録</a></button>
    </div>
  </div>
  <script>
    $(function() {
      const token = getParam('register_token');
      console.log(token);
      // ［登録］ボタンクリックで検索開始
      $('#register').click(function() {
        const gender = $('input:radio[name="gender"]:checked').val();
        var password = $('#pass').val();
        $.ajax('https://kensyu.jeez.jp/api/user',
          {
            type: 'post',
            data: { "token":token,"password":password,"gender" : gender },
            dataType : "json"
          }
        )
        .done(function(data,status, xhr) {
          window.alert('会員登録に成功しました。ログイン画面からログインしてください。');
          location.href = "./login.html";
        })
        .fail(function() {
          window.alert('登録に失敗しました。');
        });
      });
    });
  </script>
</body>
</html>
