<!DOCTYPE html>
<html>
<head>
  <%- include('config/_head'); %>

</head>
<body>
  <%- include('component/_profile'); %>
  <div class="vo-contents">
    <h2 class="vo-title vo-title--h5 vu-mb16"><i class="vo-icon vo-icon--yellow vu-mr08 fas fa-star"></i>あなたのvote</h2>
    <div class="vo-card--wrapper">
      <!-- <div class="vo-card">
        <a href="mypage-detail.html">
          <div class="vo-card__image">
            <img src="./assets/img/pizza.png">
          </div>
          <div class="vo-card__title">
            <p>寿司</p>
          </div>
        </a>
      </div>
      <div class="vo-card">
        <div class="vo-card__image">
          <img src="./assets/img/pizza.png">
        </div>
        <div class="vo-card__title">
          <p>カレー</p>
        </div>
      </div>
      <div class="vo-card">
        <div class="vo-card__image">
          <img src="./assets/img/pizza.png">
        </div>
        <div class="vo-card__title">
          <p>パスタ</p>
        </div>
      </div>
      <div class="vo-card">
        <div class="vo-card__image">
          <img src="./assets/img/pizza.png">
        </div>
        <div class="vo-card__title">
          <p>ピザ</p>
        </div>
      </div>
      <div class="vo-card">
        <div class="vo-card__image">
          <img src="./assets/img/pizza.png">
        </div>
        <div class="vo-card__title">
          <p>うどん/そば</p>
        </div>
      </div>
      <div class="vo-card">
        <div class="vo-card__image">
          <img src="./assets/img/pizza.png">
        </div>
        <div class="vo-card__title">
          <p>タピオカ</p>
        </div>
      </div>
      <div class="vo-card">
        <div class="vo-card__image">
          <img src="./assets/img/pizza.png">
        </div>
        <div class="vo-card__title">
          <p>中華</p>
        </div>
      </div>
      <div class="vo-card">
        <div class="vo-card__image">
          <img src="./assets/img/pizza.png">
        </div>
        <div class="vo-card__title">
          <p>ラーメン</p>
        </div>
      </div>
      <div class="vo-card">
        <div class="vo-card__image">
          <img src="./assets/img/pizza.png">
        </div>
        <div class="vo-card__title">
          <p>ハンバーグ</p>
        </div>
      </div>
      <div class="vo-card">
        <div class="vo-card__image">
          <img src="./assets/img/pizza.png">
        </div>
        <div class="vo-card__title">
          <p>ハンバーガー</p>
        </div>
      </div>
      <div class="vo-card">
        <div class="vo-card__image">
          <img src="./assets/img/pizza.png">
        </div>
        <div class="vo-card__title">
          <p>オムライス</p>
        </div>
      </div> -->
    </div>
    <div id="modal" style="display:none;">
      <p>これはサンプルです。</p>
    </div>
  </div>
  <%- include('component/_footer'); %>
  <script>
      window.onload = function() {
        $.ajax('https://kensyu.jeez.jp/api/mypage',
          {
            headers: {
              "token" : getToken()
            },
            type: 'get'
          }
        )
        // 検索成功時にはページに結果を反映
        .done(function(data) {
          console.log(data['user']);
          $('.vo-profile__name').text("ゲストユーザー"+data["result"]["user"]["id"]);
        })
        // 認証失敗はloginページに
        .fail(function(data, status, xhr) {
          if (data.status === 401) {
            alert("ログイン認証に失敗しました");
            location.href="./login.html";
          }else{
            alert("予期せぬエラーが発生しました");
          }
        });

        $.ajax('https://kensyu.jeez.jp/api/category',
          {
            type: 'get'
          }
        )
        // 検索成功時にはページに結果を反映
        .done(function(data) {
          var categories = data['result']['categories'];
          for(var i = 0; i < categories.length; i++){
            $('.vo-card--wrapper').append(
            '<div class="vo-card">'+
              '<a href="mypage-detail.html?category='+categories[i]['id']+'">'+
                '<div class="vo-card__image">'+
                  '<img src="./assets/img/pizza.png">'+
                '</div>'+
                '<div class="vo-card__title">'+
                  '<p>'+categories[i]['name']+'</p>'+
                '</div>'+
              '</a>'+
            '</div>'
            );
          }
        })
        // 検索失敗時には、その旨をダイアログ表示
        .fail(function(data) {
          console.error(data)
        });
      };
  </script>
</body>
</html>
